root /usr/share/nginx/html;
# Pasta onde estão os arquivos React compilados

location / {
  try_files $uri $uri/ /index.html;
} 
# Se user clica em /products/123
# Nginx primeiro procura arquivo /products/123
# Se não encontrar, procura pasta /products/
# Se não encontrar, retorna /index.html
# React Router então renderiza a página correta
# Isso é essencial para SPAs!

location ~* \.(js|css|png|jpg|...) {
    expires 1y;
}
# Arquivos estáticos (JS, CSS, imagens) nunca mudam
# Diz ao navegador: "Guarde esse arquivo por 1 ano"
# Próxima vez que abrir página, carrega do cache (muito rápido!)

location /api/ {
    proxy_pass http://backend:8000/api/;
}
# Quando React faz requisição para /api/users/
# Nginx reencaminha para http://backend:8000/api/users/
# backend = nome do container Django na rede Docker
# Resposta volta para React automaticamente

proxy_set_header X-Real-IP $remote_addr;
# Diz ao Django qual é o IP real do cliente
# Sem isso, Django acha que todo request vem do Nginx